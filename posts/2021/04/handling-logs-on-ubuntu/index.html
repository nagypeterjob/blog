<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Handling logs on Ubuntu</title>
  <meta name="description" content="A guide to come up with sane defaults for log handling">
  <meta name="author" content="Peter Nagy">
  <meta name="roboots" content="index, archive, follow">
  <meta name="googlebot" content="index, follow">

  <script>
    window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
    ga('create', 'UA-67534623-1', 'auto');
    ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
  <link rel="stylesheet" href="../../../../css/main.css?v=1.0">
  <link rel="icon" type="image/x-icon" href="../../../../icons/favicon.ico">
  <link rel="apple-touch-icon" sizes="120x120" href="../../../../icons/apple-touch-icon-120x120.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="../../../../icons/apple-touch-icon-152x152.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="../../../../icons/apple-touch-icon-180x180.png" />
</head>

<body>
    <div class="container-fluid underline head">
      <div class="container header">
        <div class="row">
          <div class="col">
            <div class="logo">
              Peter is doing platform
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div class="disclaimer">
              The opinions expressed on this blog are purely mine
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <ul>
              <li><a href="../../../../">blog</a></li>
              <li><a href="https://github.com/nagypeterjob">github</a></li>
              <li><a href="https://twitter.com/ngy_ptr">twitter</a></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="container article">
        <div class="row">
            <div class="col post">
                <h1>Handling logs on Ubuntu</h1>

                <h2>System log defaults</h2>
                not full list, just logs who take up place
                <table class="table table-bordered">
                    <thead>
                      <tr>
                        <th scope="col">File</th>
                        <th scope="col">Rotated naming</th>
                        <th scope="col">Frequency</th>
                        <th scope="col">Type</th>
                      </tr>
                    </thead>
                    <tbody> 
                      <tr>
                        <th scope="row">apt/*</th>
                        <td>history.log.{n}.gz, term.log.{n}.gz</td>
                        <td>weekly</td>
                        <td>text</td>
                      </tr>
                      <tr>
                        <th scope="row">atop/*</th>
                        <td>atop_YYYYMMDD</td>
                        <td>3 days</td>
                        <td>binary</td>
                      </tr>
                      <tr>
                        <th scope="row">auth.log</th>
                        <td>auth.log.{n}.gz</td>
                        <td>monthly</td>
                        <td>text</td>
                      </tr>
                      <tr>
                        <th scope="row">cloud-init.log, cloud-init-output.log</th>
                        <td>-</td>
                        <td>can be deleted after 3 days</td>
                        <td>text</td>
                      </tr>
                      <tr>
                        <th scope="row">dpkg.log</th>
                        <td>dpkg.log.{n}.gz</td>
                        <td>7 days</td>
                        <td>text</td>
                      </tr>
                      <tr>
                        <th scope="row">faillog</th>
                        <td>-</td>
                        <td>monthly</td>
                        <td>text</td>
                      </tr>
                      <tr>
                        <th scope="row">faillog</th>
                        <td>-</td>
                        <td>weekly</td>
                        <td>text</td>
                      </tr>
                      <tr>
                        <th scope="row">kern.log</th>
                        <td>kern.log.{n}.gz</td>
                        <td>3 days</td>
                        <td>text</td>
                      </tr>
                      <tr>
                        <th scope="row">lastlog</th>
                        <td>-</td>
                        <td>monthly</td>
                        <td>binary</td>
                      </tr>
                      <tr>
                        <th scope="row">syslog.log</th>
                        <td>syslog.log.{n}.gz</td>
                        <td>3 days</td>
                        <td>text</td>
                      </tr>
                      <tr>
                        <th scope="row">wtmp</th>
                        <td>-</td>
                        <td>monthly</td>
                        <td>binary</td>
                      </tr>
                    </tbody>
                  </table>

                <h2>Syslog & Journual</h2>
                Journual forwards logs stdout & stderr to syslog
                stop all logging or stop on a per-service basis

                <h3>Logrotate</h3>



                <h2>systemd + syslog</h2>
                what to do
                <h2>Docker logs</h2>
                Docker logs location: /var/lib/docker/containers/*/*-json.log
                <pre>
                    <code>
#daemon.json
{
    "log-driver": "json-file",
    "log-opts": {
        "max-size": "10m",
        "max-file": "5"
    }
}
                    </code>
                </pre>
                <h2>Forwarding logs</h2>
                rsyslog
                fluent
                <hr/>
            </div>
        </div>
    </div>
</body>
</html>